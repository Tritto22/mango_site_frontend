"use strict";(self["webpackChunkmango_site"]=self["webpackChunkmango_site"]||[]).push([[631],{631:function(t,e,i){i.r(e),i.d(e,{default:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("section",[t.submitted?t._e():e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row col-md-8 offset-md-2"},[e("div",{staticClass:"card w-100"},[e("div",{staticClass:"card-body"},[e("form",{attrs:{role:"form"},on:{submit:function(e){return e.preventDefault(),t.addPainting.apply(null,arguments)}}},[e("div",{staticClass:"form-group mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"title"}},[t._v("Titolo")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.painting.title,expression:"painting.title"}],staticClass:"form-control",attrs:{id:"title",placeholder:"Inserisci il titolo",type:"text"},domProps:{value:t.painting.title},on:{input:[function(e){e.target.composing||t.$set(t.painting,"title",e.target.value)},t.validateTitle]}}),t.isTitleValid?t._e():e("p",{staticClass:"text-danger"},[t._v("Il titolo non puÃ² essere vuoto o contenere solo spazi!")])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label",attrs:{for:"imageDataBytes"}},[t._v("Link immagine quadro file")]),e("input",{staticClass:"form-control-file",attrs:{type:"file",id:"imageDataBytes"},on:{change:t.handleFileChange}})]),e("div",{staticClass:"mb-3"},[t.countDetails>0&&t.painting.details.length>0?e("div",{staticClass:"mb-3"},t._l(t.countDetails,(function(i){return e("div",{key:i,staticClass:"detail mb-2"},[e("label",{staticClass:"form-label",attrs:{for:"i"}},[t._v("Link dettaglio quadro")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.painting.details[i-1].name,expression:"painting.details[i-1].name"}],staticClass:"form-control mb-1",attrs:{type:"text",id:i,placeholder:"Inserisci il nome del dettaglio"},domProps:{value:t.painting.details[i-1].name},on:{input:function(e){e.target.composing||t.$set(t.painting.details[i-1],"name",e.target.value)}}}),e("input",{staticClass:"form-control-file",attrs:{type:"file",id:i},on:{change:function(e){return t.handleFileChangeDetailImg(e,i-1)}}}),t.errors.details?e("p",{staticClass:"text-danger"},[t._v(t._s(t.errors.details))]):t._e()])})),0):t._e(),e("button",{staticClass:"btn btn-info",attrs:{type:"button"},on:{click:t.addDetail}},[t._v("Aggiungi dettaglio")])]),e("div",{staticClass:"form-group mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"size"}},[t._v("Misure")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.painting.size,expression:"painting.size"}],staticClass:"form-control",attrs:{id:"size",placeholder:"Inserisci le misure",type:"text"},domProps:{value:t.painting.size},on:{input:function(e){e.target.composing||t.$set(t.painting,"size",e.target.value)}}}),t.errors.size?e("p",{staticClass:"text-danger"},[t._v(t._s(t.errors.size))]):t._e()]),e("div",{staticClass:"form-group mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"year"}},[t._v("Anno")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.painting.year,expression:"painting.year"}],staticClass:"form-control",attrs:{id:"year",placeholder:"Inserisci l'anno",type:"text"},domProps:{value:t.painting.year},on:{input:[function(e){e.target.composing||t.$set(t.painting,"year",e.target.value)},t.validateYear]}}),t.isYearValid?t._e():e("p",{staticClass:"text-danger"},[t._v("L'anno deve essere compreso tra il 1993 e il 2199 ")])]),e("div",{staticClass:"form-group mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"tecnique"}},[t._v("Tecnica utilizzata")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.painting.tecnique,expression:"painting.tecnique"}],staticClass:"form-control",attrs:{id:"tecnique",placeholder:"Inserisci le misure",type:"text"},domProps:{value:t.painting.tecnique},on:{input:function(e){e.target.composing||t.$set(t.painting,"tecnique",e.target.value)}}}),t.errors.tecnique?e("p",{staticClass:"text-danger"},[t._v(t._s(t.errors.tecnique))]):t._e()]),e("div",{staticClass:"form-group mb-3"},[e("label",{staticClass:"form-label",attrs:{for:"description"}},[t._v("Descrizione")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.painting.description,expression:"painting.description"}],staticClass:"form-control",attrs:{id:"description",placeholder:"Inserisci la nuova descrizione",rows:"5"},domProps:{value:t.painting.description},on:{input:function(e){e.target.composing||t.$set(t.painting,"description",e.target.value)}}}),t.errors.description?e("p",{staticClass:"text-danger"},[t._v(t._s(t.errors.description))]):t._e()]),e("div",{staticClass:"form-group form-check mb-3"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.painting.favorite,expression:"painting.favorite"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"favorite",role:"button"},domProps:{checked:Array.isArray(t.painting.favorite)?t._i(t.painting.favorite,null)>-1:t.painting.favorite},on:{change:function(e){var i=t.painting.favorite,a=e.target,s=!!a.checked;if(Array.isArray(i)){var n=null,r=t._i(i,n);a.checked?r<0&&t.$set(t.painting,"favorite",i.concat([n])):r>-1&&t.$set(t.painting,"favorite",i.slice(0,r).concat(i.slice(r+1)))}else t.$set(t.painting,"favorite",s)}}}),e("label",{staticClass:"form-check-label",attrs:{for:"favorite"}},[t._v("Aggiungi ai preferiti")])]),t._m(0)])])])])]),t.submitted?e("div",{class:t.successful?"alert-success text-center":"alert-danger text-center"},[e("h3",[t._v(t._s(t.message))])]):t._e()])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Crea")])])}],n=i(908),r={name:"NewPainting",data(){return{painting:{favorite:!1,details:[]},imageDataBytes:null,successful:!1,submitted:!1,message:"",isTitleValid:!0,isYearValid:!0,countDetails:0}},computed:{currentUser(){return this.$store.state.auth.user}},mounted(){this.currentUser||this.$router.push("/admin/login")},methods:{addPainting(){this.submitted=!0,this.painting.details.length>0&&null==this.painting.details[0].name&&null==this.painting.details[0].imageBase64&&(this.painting.details=null),n.Z.newPainting(this.painting).then((t=>{null!=t.data.payload?(this.message="Nuovo quadro aggiunto con successo!",this.successful=!0):null!=t.data.error&&(this.message=t.data.error.msg,this.successful=!1)}),(t=>{this.message=t.response&&t.response.data||t.message||t.toString(),this.successful=!1,t.response&&403===t.response.status&&(this.$store.dispatch("auth/logout"),this.$router.push("/admin/login"))}))},validateTitle(){this.isTitleValid=""!==this.painting.title.trim()},validateYear(){this.painting.year>=1993&&this.painting.year<=2199?this.isYearValid=!0:this.isYearValid=!1},addDetail(){this.countDetails++,this.painting.details.push({})},handleFileChange(t){const e=t.target,i=e.files[0];i&&this.readFile(i)},readFile(t){const e=new FileReader;e.onload=t=>{this.painting.imageDataBase64=t.target.result},e.readAsDataURL(t)},handleFileChangeDetailImg(t,e){const i=t.target,a=i.files[0];a&&this.readFileDetail(a,e)},readFileDetail(t,e){const i=new FileReader;i.onload=t=>{this.painting.details[e].imageBase64=t.target.result},i.readAsDataURL(t)}}},l=r,o=i(1),d=(0,o.Z)(l,a,s,!1,null,null,null),c=d.exports},908:function(t,e,i){var a=i(121),s=i(8);const n="https://www.simonetritto.site/api/admin/";a.Z.defaults.headers.common["Access-Control-Allow-Origin"]="*",a.Z.defaults.headers.common["Access-Control-Allow-Headers"]="Origin, X-Requested-With, Content-Type, Accept",a.Z.defaults.withCredentials=!1,a.Z.defaults.crossDomain=!0;class r{newPainting(t){return""!==t.title&&t.year>=1993&&t.year<=2199?a.Z.post(n+"addPainting",t,{headers:(0,s.Z)()}):Promise.reject("I dati del quadro non sono validi. Il titolo e l'anno non possono essere vuoti.")}getDashboard(t,e){return a.Z.get(`${n}dashboard?pageNumber=${t}&pageSize=${e}`,{headers:(0,s.Z)()})}getSinglePainting(t){return a.Z.get(`${n}single-view?slug=${t}`,{headers:(0,s.Z)()})}update(t){return""!==t.title&&t.year>=1993&&t.year<=2199?a.Z.put(n+"update",t,{headers:(0,s.Z)()}):Promise.reject("I dati del quadro non sono validi.")}delete(t){if(null!=t.slug)return a.Z.delete(n+"delete",{data:t,headers:(0,s.Z)()})}}e.Z=new r}}]);
//# sourceMappingURL=631.95c65350.js.map